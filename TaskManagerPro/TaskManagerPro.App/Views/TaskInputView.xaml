<UserControl x:Class="TaskManagerPro.App.Views.TaskInputView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300"
             BorderBrush="#0078D4" BorderThickness="2" Background="White">
    <UserControl.Effect>
        <DropShadowEffect BlurRadius="10" ShadowDepth="4" Opacity="0.3"/>
    </UserControl.Effect>
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="{Binding FormTitle}" FontWeight="Bold" FontSize="16" Margin="0,0,0,10" Foreground="#0078D4"/>

        <!-- Title -->
        <TextBlock Text="Title" FontWeight="SemiBold" Margin="0,0,0,2" Grid.Row="1"/>
        <TextBox Grid.Row="2" Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}" Padding="5" Margin="0,0,0,10" BorderBrush="#cccccc"/>

        <!-- Details Grid -->
        <Grid Grid.Row="3" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Effort -->
            <TextBlock Text="Effort (h)" FontWeight="SemiBold" Grid.Row="0" Grid.Column="0"/>
            <TextBox Text="{Binding EffortHours, UpdateSourceTrigger=PropertyChanged}" Grid.Row="1" Grid.Column="0" Margin="0,0,5,10" Padding="5"/>

            <!-- Due Date -->
            <TextBlock Text="Due Date" FontWeight="SemiBold" Grid.Row="0" Grid.Column="1"/>
            <DatePicker SelectedDate="{Binding DueDate, UpdateSourceTrigger=PropertyChanged}" Grid.Row="1" Grid.Column="1" Margin="5,0,0,10"/>

            <!-- Impact -->
            <TextBlock Text="Impact" FontWeight="SemiBold" Grid.Row="2" Grid.Column="0"/>
            <ComboBox Grid.Row="3" Grid.Column="0" SelectedItem="{Binding ImpactScore, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,5,0" Padding="5">
                <ComboBox.ItemsSource>
                    <x:Array Type="{x:Type system:Int32}">
                        <system:Int32>1</system:Int32>
                        <system:Int32>2</system:Int32>
                        <system:Int32>3</system:Int32>
                        <system:Int32>4</system:Int32>
                        <system:Int32>5</system:Int32>
                        <system:Int32>6</system:Int32>
                        <system:Int32>7</system:Int32>
                        <system:Int32>8</system:Int32>
                        <system:Int32>9</system:Int32>
                        <system:Int32>10</system:Int32>
                    </x:Array>
                </ComboBox.ItemsSource>
            </ComboBox>
            
            <!-- Urgency -->
            <TextBlock Text="Urgency" FontWeight="SemiBold" Grid.Row="2" Grid.Column="1"/>
            <ComboBox Grid.Row="3" Grid.Column="1" SelectedItem="{Binding UrgencyScore, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,0,0" Padding="5">
                <ComboBox.ItemsSource>
                    <x:Array Type="{x:Type system:Int32}">
                        <system:Int32>1</system:Int32>
                        <system:Int32>2</system:Int32>
                        <system:Int32>3</system:Int32>
                        <system:Int32>4</system:Int32>
                        <system:Int32>5</system:Int32>
                        <system:Int32>6</system:Int32>
                        <system:Int32>7</system:Int32>
                        <system:Int32>8</system:Int32>
                        <system:Int32>9</system:Int32>
                        <system:Int32>10</system:Int32>
                    </x:Array>
                </ComboBox.ItemsSource>
            </ComboBox>
        </Grid>

        <!-- Description -->
        <TextBlock Text="Description" FontWeight="SemiBold" Grid.Row="4" Margin="0,0,0,2"/>
        <TextBox Grid.Row="5" Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Padding="5" Margin="0,0,0,15" BorderBrush="#cccccc"/>

        <!-- Buttons -->
        <!-- Commands will be bound from the parent ViewModel via RelativeSource or expecting the DataContext to have commands -->
        <!-- However, DataContext here is likely TaskDetailViewModel, which doesn't have Save/Cancel logic (that's in MainWindowViewModel). -->
        <!-- So we need to bind commands to properties in TaskDetailViewModel OR use RelativeSource to find MainWindowViewModel. -->
        <!-- The cleanest way for inline: Pass the MAIN VM commands to this view, or execute logic in the VM bound to this view. -->
        <!-- But TaskDetailViewModel is just a DTO wrapper. Logic is in MainWindowViewModel. -->
        <!-- We will use RelativeSource in MainWindow.xaml to bind the buttons of this UserControl to MainWindowViewModel's commands. -->
        <!-- Ideally, we expose public ICommand properties on this UserControl code-behind or rely on the binding context structure. -->
        <!-- For MVP simplicity, we'll put the Buttons here but bind them assuming the DataContext has commands or we use RelativeSource in the Button definition. -->
        
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Cancel" Width="80" Height="30" Margin="0,0,10,0" 
                    Command="{Binding DataContext.CancelEditCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            <Button Content="Save" Width="80" Height="30" Background="#0078D4" Foreground="White" BorderThickness="0"
                    Command="{Binding DataContext.SaveTaskCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
        </StackPanel>
    </Grid>
</UserControl>
